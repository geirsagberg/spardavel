name: Mark Copilot PR as Ready for Review

on:
  pull_request:
    types: [labeled]

permissions:
  contents: read
  pull-requests: write

jobs:
  mark-ready:
    runs-on: ubuntu-latest
    # Only run if the PR is a draft and has the copilot-ready label
    if: |
      github.event.pull_request.draft == true &&
      github.event.label.name == 'copilot-ready'
    steps:
      - name: Mark PR as ready for review
        env:
          GH_TOKEN: ${{ github.token }}
          PR_NUMBER: ${{ github.event.pull_request.number }}
          REPO: ${{ github.repository }}
        run: |
          echo "Marking PR #${PR_NUMBER} as ready for review"
          gh pr ready "${PR_NUMBER}" --repo "${REPO}"
